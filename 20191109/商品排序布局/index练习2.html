<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
<link rel="stylesheet" href="./css/1.css">
</head>
<body>
   <section class="box">
        <nav>
            <span>排序</span>
            <a href="javascript:void(0);" data-name="time">
                <i class="up"></i>
                <i class="down"></i>
                上架时间
            </a>
            <a href="javascript:void(0);" data-name="hot">
                <i class="up"></i>
                <i class="down"></i>
                热度
            </a>
            <a href="javascript:void(0);" data-name="price">
                <i class="up "></i>
                <i class="down"></i>
                价钱
            </a>
            <div>
                 <select name="" id="sele">
                    <option value="hot">按照热度搜索</option>
                    <option value="price">按照价格搜索</option>
                    <option value="hot">按照文字搜索</option>
                </select>
                <input type="text">
                <button id="search">搜索</button>
            </div>
        </nav>
        <ul class="list" id="ul">
             <!-- `<li>
                <img src="./img/2.jpg" alt="">
                <p>商品名称:<span>dsdsadsads</span></p>
                <p>上架时间:<span>2019-10-10</span></p>
                <p>商品热度:<span>32</span></p>
                <p>商品价格::<span>200</span></p>
            </li>` -->
        </ul>
       
   </section>

<script>
   //获取后台数据
   fetch('./json/product.json')
   .then(d=>d.json()).then(data=>{
      //console.log(data);数据读取成功
      //赋值一份新数据,不影响原数据
      let newdata = data.slice();//concat() console.log(newdata);
      function render(newdata){
          let lists = newdata.map((item,i)=>{ 
              return( `<li><img src="${item.img}" alt="">
                <p>商品名称:<span>${item.title.substr(0,6)}</span></p>
                <p>上架时间:<span>${item.time}</span></p>
                <p>商品热度:<span>${item.hot}</span></p>
                <p>商品价格::<span>${item.price}</span></p>
            </li>`);
        }).join('');
        console.log(lists);
        
   ul.innerHTML = lists;
   }    
      render(newdata)   

    let as = document.querySelectorAll('a');
   
    as.forEach((item,i)=>{
    //给每个a标签绑定一个自定义开关属性 
      item.onoff =true;
      item.onclick= function(){
        if(this.onoff){
                newdata.sort((a,b)=>{
                 //点击每个li 通过索引判断执行相应排序方法
                  switch(i){
                      case 0: 
                       return Number(a.time.replace('-','').replace('-',''))
                       -Number(b.time.replace('-','').replace('-',''));
                       break;
                      case 1: 
                        return a.hot - b.hot;
                        break; 
                      case 2: 
                        return a.price - b.price;
                        }
                       })

                this.children[1].classList.remove('activeb');
                this.children[0].classList.add('activet');  
                   }
        
                  else{
                    
                    newdata.sort((a,b)=>{
                    switch(i){ 
                      case 0:
                      return Number(b.time.replace('-','').replace('-',''))
                       -Number(a.time.replace('-','').replace('-',''));
                        break;  
                      case 1: 
                        return b.hot - a.hot;
                        break;
                      case 2: 
                        return b.price - a.price;
                                       }
                                       })
                this.children[0].classList.remove('activet');
                this.children[1].classList.add('activeb');                   
                   }
               
                 this.onoff = !this.onoff;
                 render(newdata);
                 
                
                }
         
         });
        });        
          
        
</script>
</body>
</html>